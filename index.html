<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Управление задачами</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        #tasks {
            margin-bottom: 20px;
        }
        .task {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Список задач</h1>
    <div id="tasks"></div>
    <input type="text" id="newTask" placeholder="Новая задача">
    <button onclick="addTask()">Добавить</button>

    <script>
        // Инициализация Web App
        Telegram.WebApp.ready();

        // Загрузка задач при открытии
        function loadTasks() {
            Telegram.WebApp.sendData(JSON.stringify({ action: "get_tasks" }));
        }

        // Обработка входящих данных от бота
        Telegram.WebApp.onEvent("message", (data) => {
            const tasks = JSON.parse(data);
            const tasksContainer = document.getElementById("tasks");
            tasksContainer.innerHTML = "";
            tasks.forEach((task, index) => {
                const taskElement = document.createElement("div");
                taskElement.className = "task";
                taskElement.innerHTML = `
                    ${index + 1}. ${task}
                    <button onclick="removeTask(${index})">Удалить</button>
                `;
                tasksContainer.appendChild(taskElement);
            });
        });

        // Добавление задачи
        function addTask() {
            const newTask = document.getElementById("newTask").value;
            if (newTask) {
                Telegram.WebApp.sendData(JSON.stringify({
                    action: "add_task",
                    task: newTask
                }));
                document.getElementById("newTask").value = "";
            } else {
                alert("Введите задачу!");
            }
        }

        // Удаление задачи
        function removeTask(index) {
            Telegram.WebApp.sendData(JSON.stringify({
                action: "remove_task",
                index: index
            }));
        }

        // Загрузить задачи при открытии
        loadTasks();
    </script>
</body>
</html>
